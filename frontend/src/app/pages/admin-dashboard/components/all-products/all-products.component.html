<div class="card shadow-sm mb-4">
  <div class="card-header">All Products</div>
  <div class="table-responsive">
    <table class="table table-sm mb-0">
      <thead>
        <tr>
          <th>Name</th>
          <th>Price</th>
          <th>Stock</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let product of products">
          <td>
            <ng-container *ngIf="editingId !== product._id; else editName">{{ product.name }}</ng-container>
            <ng-template #editName>
              <input class="form-control form-control-sm" [(ngModel)]="draft.name" />
            </ng-template>
          </td>
          <td>
            <ng-container *ngIf="editingId !== product._id; else editPrice">
              {{ product.price | currency: "USD" }}
            </ng-container>
            <ng-template #editPrice>
              <input class="form-control form-control-sm" type="number" [(ngModel)]="draft.price" />
            </ng-template>
          </td>
          <td>
            <ng-container *ngIf="editingId !== product._id; else editStock">{{ product.stock || 0 }}</ng-container>
            <ng-template #editStock>
              <input class="form-control form-control-sm" type="number" [(ngModel)]="draft.stock" />
            </ng-template>
          </td>
          <td class="text-end">
            <ng-container *ngIf="editingId !== product._id; else editActions">
              <button class="btn btn-outline-primary btn-sm me-2" (click)="beginEdit(product)">Edit</button>
              <button class="btn btn-outline-danger btn-sm" (click)="deleteProduct(product._id)">Delete</button>
            </ng-container>
            <ng-template #editActions>
              <button class="btn btn-success btn-sm me-2" (click)="saveEdit()">Save</button>
              <button class="btn btn-outline-secondary btn-sm" (click)="cancelEdit()">Cancel</button>
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
